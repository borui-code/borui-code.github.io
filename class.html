<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<link rel="icon" href="classroom.ico" type="image/x-icon">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å…¨ç­ç¶²å€åå–®</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body { font-family: "Noto Sans TC", "Segoe UI", sans-serif; background: linear-gradient(135deg, #e5f1ff, #f7faff); color: #1e293b; display: flex; justify-content: center; align-items: flex-start; padding: 50px 0; }
  .container { background: #fff; border-radius: 16px; box-shadow:0 0 15px rgba(59,130,246,0.15),0 0 25px rgba(96,165,250,0.1); border: 1px solid rgba(147,197,253,0.3); padding: 40px; width: 95%; max-width: 1100px; transition: box-shadow 0.3s ease; }
  .container:hover { box-shadow:0 0 18px rgba(96,165,250,0.25),0 0 40px rgba(59,130,246,0.15); }
  h1 { text-align: center; color: #1e40af; margin-bottom: 1.2rem; font-size: 1.7rem; letter-spacing: 0.5px; }
  .search-box { display: flex; justify-content: flex-end; margin-bottom: 1rem; }
  .search-box input { padding: 8px 14px; border: 1px solid #cbd5e1; border-radius: 8px; width: 240px; font-size: 0.95rem; outline: none; transition: all 0.3s; }
  .search-box input:focus { border-color: #3b82f6; box-shadow: 0 0 8px rgba(96,165,250,0.4); }
  table { width: 100%; border-collapse: collapse; }
  thead { background-color: #eff6ff; }
  th, td { padding: 12px 14px; text-align: left; }
  th { cursor: pointer; font-weight: 600; color: #1d4ed8; user-select: none; position: relative; }
  th:hover { background-color: #dbeafe; }
  td { border-top: 1px solid #e2e8f0; }
  tr:hover td { background-color: #f1f5f9; }
  .arrow { font-size: 0.8rem; margin-left: 6px; color: #94a3b8; }
  a { color: #2563eb; text-decoration: none; }
  a:hover { text-decoration: underline; }
  .footer { text-align: center; margin-top: 1rem; color: #64748b; font-size: 0.85rem; }
  ::-webkit-scrollbar { width: 8px; }
  ::-webkit-scrollbar-thumb { background: rgba(59,130,246,0.4); border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: rgba(59,130,246,0.6); }

  td.last-seen, th:last-child {
    width: 180px;
    min-width: 180px;
    text-align: left;
  }
</style>
</head>
<body>

<a href="index.html" id="backHomeBtn">ğŸ  å›é¦–é </a>

<style>
  #backHomeBtn {
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: #4CAF50; /* ç¶ è‰² */
    color: white;
    padding: 10px 15px;
    text-decoration: none;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    font-weight: bold;
    transition: all 0.3s ease;
    z-index: 1000;
  }

  #backHomeBtn:hover {
    background-color: #45a049;
    transform: scale(1.1);
  }

  .table-container {
    overflow-x: auto;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    word-wrap: break-word;
  }

  td, th {
    padding: 8px;
    text-align: left;
    word-break: break-all;
  }

  @media (max-width: 600px) {
    .home-btn {
      font-size: 12px;
      padding: 6px 10px;
      top: 8px;
      right: 8px;
    }
  }

  td a {
    white-space: nowrap; /* ä¸æ›è¡Œ */
  }
</style>

<div class="container">
  <h1>å…¨ç­ç¶²å€åå–®</h1>

  <div class="search-box">
    <input type="text" id="searchInput" placeholder="ğŸ” æœå°‹å­¸è™Ÿæˆ–å§“å">
  </div>

  <div class="table-container">
  <table id="studentTable">
    <thead>
      <tr>
        <th data-key="no">é …æ¬¡ <span class="arrow">â‡…</span></th>
        <th data-key="id">å­¸è™Ÿ <span class="arrow">â‡…</span></th>
        <th data-key="name">å§“å <span class="arrow">â‡…</span></th>
        <th>ç¶²é é€£çµ</th>
        <th>æœ€å¾Œè§€çœ‹æ™‚é–“</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td>C114110101</td>
        <td>éƒ­æŸéŠ³</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110101/">å‰å¾€ç¶²ç«™</a></td>
        <td class="last-seen" data-id="C114110101">-</td>
      </tr>
      <tr>
        <td>2</td>
        <td>C114110102</td>
        <td>éƒ­ç•‡é‹’</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110102/">å‰å¾€ç¶²ç«™</a></td>
        <td class="last-seen" data-id="C114110102">-</td>
      </tr>
      <tr>
        <td>3</td>
        <td>C114110103</td>
        <td>å³å“é ¤</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110103/">å‰å¾€ç¶²ç«™</a></td>
        <td class="last-seen" data-id="C114110103">-</td>
      </tr>
      <tr>
        <td>4</td>
        <td>C114110104</td>
        <td>æœ±æŸå¨</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110104/">å‰å¾€ç¶²ç«™</a></td>
        <td class="last-seen" data-id="C114110104">-</td>
      </tr>
      <tr>
        <td>5</td>
        <td>C114110105</td>
        <td>ç°¡é–æ˜€</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110105/">https://www2.nkust.edu.tw/~c114110105</a></td>
        <td class="last-seen" data-id="C114110105">-</td>
      </tr>
      <tr>
        <td>6</td>
        <td>C114110106</td>
        <td>é¾æ™ºå®‡</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110106/">https://www2.nkust.edu.tw/~c114110106</a></td>
        <td class="last-seen" data-id="C114110106">-</td>
      </tr>
      <tr>
        <td>7</td>
        <td>C114110107</td>
        <td>é»ƒå¥•ç¿”</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110107/">https://www2.nkust.edu.tw/~c114110107</a></td>
        <td class="last-seen" data-id="C114110107">-</td>
      </tr>
      <tr>
        <td>8</td>
        <td>C114110108</td>
        <td>ææ³“å¿—</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110108/">https://www2.nkust.edu.tw/~c114110108</a></td>
        <td class="last-seen" data-id="C114110108">-</td>
      </tr>
      <tr>
        <td>9</td>
        <td>C114110109</td>
        <td>æ›¾ç¿éœ†</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110109/">https://www2.nkust.edu.tw/~c114110109</a></td>
        <td class="last-seen" data-id="C114110109">-</td>
      </tr>
      <tr>
        <td>10</td>
        <td>C114110110</td>
        <td>ç¨‹ç« ä½©</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110110/">https://www2.nkust.edu.tw/~c114110110</a></td>
        <td class="last-seen" data-id="C114110110">-</td>
      </tr>
      <tr>
        <td>11</td>
        <td>C114110111</td>
        <td>é™³å¥•å‡</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110111/">https://www2.nkust.edu.tw/~c114110111</a></td>
        <td class="last-seen" data-id="C114110111">-</td>
      </tr>
      <tr>
        <td>12</td>
        <td>C114110112</td>
        <td>åŠ‰å®¶å®‡</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110112/">https://www2.nkust.edu.tw/~c114110112</a></td>
        <td class="last-seen" data-id="C114110112">-</td>
      </tr>
      <tr>
        <td>13</td>
        <td>C114110113</td>
        <td>é¡å®å®¶</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110113/">https://www2.nkust.edu.tw/~c114110113</a></td>
        <td class="last-seen" data-id="C114110113">-</td>
      </tr>
      <tr>
        <td>14</td>
        <td>C114110114</td>
        <td>æ›¾å‘è¬™</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110114/">https://www2.nkust.edu.tw/~c114110114</a></td>
        <td class="last-seen" data-id="C114110114">-</td>
      </tr>
      <tr>
        <td>15</td>
        <td>C114110115</td>
        <td>æ˜“è³¢åº­</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110115/">https://www2.nkust.edu.tw/~c114110115</a></td>
        <td class="last-seen" data-id="C114110115">-</td>
      </tr>
      <tr>
        <td>16</td>
        <td>C114110116</td>
        <td>é™³è–èˆª</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110116/">https://www2.nkust.edu.tw/~c114110116</a></td>
        <td class="last-seen" data-id="C114110116">-</td>
      </tr>
      <tr>
        <td>17</td>
        <td>C114110117</td>
        <td>é™³æŸå®‡</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110117/">https://www2.nkust.edu.tw/~c114110117</a></td>
        <td class="last-seen" data-id="C114110117">-</td>
      </tr>
      <tr>
        <td>18</td>
        <td>C114110118</td>
        <td>éƒ­å½¥å®</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110118/">https://www2.nkust.edu.tw/~c114110118</a></td>
        <td class="last-seen" data-id="C114110118">-</td>
      </tr>
      <tr>
        <td>19</td>
        <td>C114110119</td>
        <td>æ›¹è±ªè‚²</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110119/">https://www2.nkust.edu.tw/~c114110119</a></td>
        <td class="last-seen" data-id="C114110119">-</td>
      </tr>
      <tr>
        <td>20</td>
        <td>C114110120</td>
        <td>é»ƒæŸèª </td>
        <td><a href="https://www2.nkust.edu.tw/~c114110120/">https://www2.nkust.edu.tw/~c114110120</a></td>
        <td class="last-seen" data-id="C114110120">-</td>
      </tr>
      <tr>
        <td>21</td>
        <td>C114110121</td>
        <td>æ²ˆå…ƒè±ª</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110121/">https://www2.nkust.edu.tw/~c114110121</a></td>
        <td class="last-seen" data-id="C114110121">-</td>
      </tr>
      <tr>
        <td>22</td>
        <td>C114110122</td>
        <td>éƒæ˜Šæ˜</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110122/">https://www2.nkust.edu.tw/~c114110122</a></td>
        <td class="last-seen" data-id="C114110122">-</td>
      </tr>
      <tr>
        <td>23</td>
        <td>C114110123</td>
        <td>æ›¾ç­ éˆ</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110123/">https://www2.nkust.edu.tw/~c114110123</a></td>
        <td class="last-seen" data-id="C114110123">-</td>
      </tr>
      <tr>
        <td>24</td>
        <td>C114110124</td>
        <td>é™³æŸæˆ</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110124/">https://www2.nkust.edu.tw/~c114110124</a></td>
        <td class="last-seen" data-id="C114110124">-</td>
      </tr>
      <tr>
        <td>25</td>
        <td>C114110125</td>
        <td>æ›¾å®¥éŠ“</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110125/">https://www2.nkust.edu.tw/~c114110125</a></td>
        <td class="last-seen" data-id="C114110125">-</td>
      </tr>
      <tr>
        <td>26</td>
        <td>C114110126</td>
        <td>å¼µè‡³ä½‘</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110126/">https://www2.nkust.edu.tw/~c114110126</a></td>
        <td class="last-seen" data-id="C114110126">-</td>
      </tr>
      <tr>
        <td>27</td>
        <td>C114110127</td>
        <td>å³æ™‰å„„</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110127/">https://www2.nkust.edu.tw/~c114110127</a></td>
        <td class="last-seen" data-id="C114110127">-</td>
      </tr>
      <tr>
        <td>28</td>
        <td>C114110128</td>
        <td>è¨±ç¿ç¿”</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110128/">https://www2.nkust.edu.tw/~c114110128</a></td>
        <td class="last-seen" data-id="C114110128">-</td>
      </tr>
      <tr>
        <td>29</td>
        <td>C114110129</td>
        <td>è”¡å®¥æ©</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110129/">https://www2.nkust.edu.tw/~c114110129</a></td>
        <td class="last-seen" data-id="C114110129">-</td>
      </tr>
      <tr>
        <td>30</td>
        <td>C114110130</td>
        <td>é™³å“å„’</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110130/">https://www2.nkust.edu.tw/~c114110130</a></td>
        <td class="last-seen" data-id="C114110130">-</td>
      </tr>
      <tr>
        <td>31</td>
        <td>C114110131</td>
        <td>å¼µç¥éŠ“</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110131/">https://www2.nkust.edu.tw/~c114110131</a></td>
        <td class="last-seen" data-id="C114110131">-</td>
      </tr>
      <tr>
        <td>32</td>
        <td>C114110132</td>
        <td>é»ƒè© ä¸</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110132/">https://www2.nkust.edu.tw/~c114110132</a></td>
        <td class="last-seen" data-id="C114110132">-</td>
      </tr>
      <tr>
        <td>33</td>
        <td>C114110133</td>
        <td>æ¥Šéˆå®‰</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110133/">https://www2.nkust.edu.tw/~c114110133</a></td>
        <td class="last-seen" data-id="C114110133">-</td>
      </tr>
      <tr>
        <td>34</td>
        <td>C114110134</td>
        <td>ç¾…å…ƒå‰</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110134/">https://www2.nkust.edu.tw/~c114110134</a></td>
        <td class="last-seen" data-id="C114110134">-</td>
      </tr>
      <tr>
        <td>35</td>
        <td>C114110135</td>
        <td>åŠ‰é–é¨°</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110135/">https://www2.nkust.edu.tw/~c114110135</a></td>
        <td class="last-seen" data-id="C114110135">-</td>
      </tr>
      <tr>
        <td>36</td>
        <td>C114110136</td>
        <td>æ—å¥•è±ª</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110136/">https://www2.nkust.edu.tw/~c114110136</a></td>
        <td class="last-seen" data-id="C114110136">-</td>
      </tr>
      <tr>
        <td>37</td>
        <td>C114110137</td>
        <td>æ—éƒå³°</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110137/">https://www2.nkust.edu.tw/~c114110137</a></td>
        <td class="last-seen" data-id="C114110137">-</td>
      </tr>
      <tr>
        <td>38</td>
        <td>C114110138</td>
        <td>é™³æŸä¸</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110138/">https://www2.nkust.edu.tw/~c114110138</a></td>
        <td class="last-seen" data-id="C114110138">-</td>
      </tr>
      <tr>
        <td>39</td>
        <td>C114110139</td>
        <td>å³èŠ¸ç†™</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110139/">https://www2.nkust.edu.tw/~c114110139</a></td>
        <td class="last-seen" data-id="C114110139">-</td>
      </tr>
      <tr>
        <td>40</td>
        <td>C114110140</td>
        <td>æ´ªä¸ä½‘</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110140/">https://www2.nkust.edu.tw/~c114110140</a></td>
        <td class="last-seen" data-id="C114110140">-</td>
      </tr>
      <tr>
        <td>41</td>
        <td>C114110141</td>
        <td>å³ç¿ä¸</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110141/">https://www2.nkust.edu.tw/~c114110141</a></td>
        <td class="last-seen" data-id="C114110141">-</td>
      </tr>
      <tr>
        <td>42</td>
        <td>C114110142</td>
        <td>å¼µç§‰éˆ</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110142/">https://www2.nkust.edu.tw/~c114110142</a></td>
        <td class="last-seen" data-id="C114110142">-</td>
      </tr>
      <tr>
        <td>43</td>
        <td>C114110143</td>
        <td>é™³æŸéˆ</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110143/">https://www2.nkust.edu.tw/~c114110143</a></td>
        <td class="last-seen" data-id="C114110143">-</td>
      </tr>
      <tr>
        <td>44</td>
        <td>C114110144</td>
        <td>æ¢çš“éˆ</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110144/">https://www2.nkust.edu.tw/~c114110144</a></td>
        <td class="last-seen" data-id="C114110144">-</td>
      </tr>
      <tr>
        <td>45</td>
        <td>C114110145</td>
        <td>å¼µç¿å˜‰</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110145/">https://www2.nkust.edu.tw/~c114110145</a></td>
        <td class="last-seen" data-id="C114110145">-</td>
      </tr>
      <tr>
        <td>46</td>
        <td>C114110146</td>
        <td>é¾å“ç§¦</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110146/">https://www2.nkust.edu.tw/~c114110146</a></td>
        <td class="last-seen" data-id="C114110146">-</td>
      </tr>
      <tr>
        <td>47</td>
        <td>C114110148</td>
        <td>é™³æŸè¿</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110148/">https://www2.nkust.edu.tw/~c114110148</a></td>
        <td class="last-seen" data-id="C114110148">-</td>
      </tr>
      <tr>
        <td>48</td>
        <td>C114110149</td>
        <td>æ—å®‡ä½‘</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110149/">https://www2.nkust.edu.tw/~c114110149</a></td>
        <td class="last-seen" data-id="C114110149">-</td>
      </tr>
      <tr>
        <td>49</td>
        <td>C114110150</td>
        <td>é‚µç¹¹æ©</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110150/">https://www2.nkust.edu.tw/~c114110150</a></td>
        <td class="last-seen" data-id="C114110150">-</td>
      </tr>
      <tr>
        <td>50</td>
        <td>C114110151</td>
        <td>é™³ä¹™é™</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110151/">https://www2.nkust.edu.tw/~c114110151</a></td>
        <td class="last-seen" data-id="C114110151">-</td>
      </tr>
      <tr>
        <td>51</td>
        <td>C114110152</td>
        <td>æ±Ÿå®¥å¾·</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110152/">https://www2.nkust.edu.tw/~c114110152</a></td>
        <td class="last-seen" data-id="C114110152">-</td>
      </tr>
      <tr>
        <td>52</td>
        <td>C114110153</td>
        <td>å¼µç¿æ´‹</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110153/">https://www2.nkust.edu.tw/~c114110153</a></td>
        <td class="last-seen" data-id="C114110153">-</td>
      </tr>
      <tr>
        <td>53</td>
        <td>C114110154</td>
        <td>åŠ‰åº·å“</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110154/">https://www2.nkust.edu.tw/~c114110154</a></td>
        <td class="last-seen" data-id="C114110154">-</td>
      </tr>
      <tr>
        <td>54</td>
        <td>C114110155</td>
        <td>æŸ¯å­¸å“²</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110155/">https://www2.nkust.edu.tw/~c114110155</a></td>
        <td class="last-seen" data-id="C114110155">-</td>
      </tr>
      <tr>
        <td>55</td>
        <td>C114110156</td>
        <td>æ­æ˜±è¬™</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110156/">https://www2.nkust.edu.tw/~c114110156</a></td>
        <td class="last-seen" data-id="C114110156">-</td>
      </tr>
      <tr>
        <td>56</td>
        <td>C114110157</td>
        <td>æå®‰å–†</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110157/">https://www2.nkust.edu.tw/~c114110157</a></td>
        <td class="last-seen" data-id="C114110157">-</td>
      </tr>
      <tr>
        <td>57</td>
        <td>C114110158</td>
        <td>å°¹é‚¦å¯Œ</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110158/">https://www2.nkust.edu.tw/~c114110158</a></td>
        <td class="last-seen" data-id="C114110158">-</td>
      </tr>
      <tr>
        <td>58</td>
        <td>C114110159</td>
        <td>æ—å¿—æº</td>
        <td><a href="https://www2.nkust.edu.tw/~c114110159/">https://www2.nkust.edu.tw/~c114110159</a></td>
        <td class="last-seen" data-id="C114110159">-</td>
      </tr>
      <tr>
        <td>59</td>
        <td>C111178109</td>
        <td>ææ¥·è˜…</td>
        <td><a href="https://www2.nkust.edu.tw/~c111178109/">https://www2.nkust.edu.tw/~c111178109</a></td>
        <td class="last-seen" data-id="C111178109">-</td>
      </tr>
      <tr>
        <td>60</td>
        <td>C114196131</td>
        <td>é»ƒå­èŠ¸</td>
        <td><a href="https://www2.nkust.edu.tw/~c114196131/">https://www2.nkust.edu.tw/~c114196131</a></td>
        <td class="last-seen" data-id="C114196131">-</td>
      </tr>
    </tbody>
  </table>
</div>

<script>
  let userId = localStorage.getItem('userId');
  if(!userId){
    userId = 'user_' + Math.random().toString(36).substr(2, 9);
    localStorage.setItem('userId', userId);
  }

  const input = document.getElementById('searchInput');
  const table = document.getElementById('studentTable');
  const rows = Array.from(table.querySelectorAll('tbody tr'));
  const headers = table.querySelectorAll('th[data-key]');

  rows.forEach(row => {
    const td = row.querySelector('.last-seen');
    const id = td.dataset.id;
    const saved = localStorage.getItem('lastSeen_' + id + '_' + userId);
    if(saved) td.innerText = saved;
  });

  input.addEventListener('input', () => {
    const keyword = input.value.toLowerCase();
    rows.forEach(row => {
      const idText = row.children[1].textContent.toLowerCase();
      const nameText = row.children[2].textContent.toLowerCase();
      row.style.display = (idText.includes(keyword) || nameText.includes(keyword)) ? '' : 'none';
    });
  });

  headers.forEach(th => {
    th.addEventListener('click', () => {
      const index = Array.from(th.parentNode.children).indexOf(th);
      const sorted = [...rows].sort((a, b) => {
        const va = a.children[index].innerText;
        const vb = b.children[index].innerText;
        return va.localeCompare(vb, 'zh-Hant', { numeric: true });
      });
      if(th.classList.toggle('desc')) sorted.reverse();
      table.querySelector('tbody').append(...sorted);
    });
  });

  function updateLastSeen(row){
    const now = new Date();
    const formatted = now.getFullYear() + '-' +
                      String(now.getMonth()+1).padStart(2,'0') + '-' +
                      String(now.getDate()).padStart(2,'0') + ' ' +
                      String(now.getHours()).padStart(2,'0') + ':' +
                      String(now.getMinutes()).padStart(2,'0') + ':' +
                      String(now.getSeconds()).padStart(2,'0');
    const td = row.querySelector('.last-seen');
    const id = td.dataset.id;
    localStorage.setItem('lastSeen_' + id + '_' + userId, formatted);
    td.innerText = formatted;
  }

  rows.forEach(row => {
    const link = row.querySelector('a');
    link.addEventListener('click', () => updateLastSeen(row));
  });
  
</script>
</body>
</html>
